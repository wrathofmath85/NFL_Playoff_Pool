<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Playoff Pick'em Hub</title>

  <!-- CSV parser (robust + easy) -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    /* ===== Chicago Bears palette ===== */
    :root{
      --navy:#0B162A;
      --navy-2:#101b33;
      --navy-3:#0e1424;
      --orange:#DC4405;
      --muted:#a9b5c7;
      --border:#27385e;
      --text:#eef3ff;
    }

    *{box-sizing:border-box;}

    html,body{
      margin:0;
      padding:0;
      background:radial-gradient(circle at top,#182748 0,var(--navy) 45%,#050813 100%);
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:24px 18px 40px;
    }

    header{
      display:flex;
      align-items:center;
      gap:18px;
      margin-bottom:22px;
      flex-wrap:wrap;
    }

    .logoBall{
      width:60px;
      height:36px;
      border-radius:999px;
      background:linear-gradient(135deg,#8a4a12,#5b2d08);
      border:2px solid #f7d7a5;
      position:relative;
      box-shadow:0 0 0 2px rgba(0,0,0,.4),0 6px 18px rgba(0,0,0,.7);
    }
    .logoBall::before,
    .logoBall::after{
      content:"";
      position:absolute;
      top:50%;
      width:12px;
      height:2px;
      background:#f7d7a5;
      transform:translateY(-50%);
    }
    .logoBall::before{left:10px;box-shadow:0 -6px 0 #f7d7a5,0 6px 0 #f7d7a5;}
    .logoBall::after{right:10px;box-shadow:0 -6px 0 #f7d7a5,0 6px 0 #f7d7a5;}
    .laces{
      position:absolute;
      top:50%;
      left:50%;
      width:26px;
      height:3px;
      background:#f7d7a5;
      transform:translate(-50%,-50%);
      border-radius:6px;
    }
    .laces span{
      position:absolute;
      width:2px;
      height:9px;
      background:#f7d7a5;
      top:50%;
      transform:translateY(-50%);
    }
    .laces span:nth-child(1){left:4px;}
    .laces span:nth-child(2){left:10px;}
    .laces span:nth-child(3){left:16px;}
    .laces span:nth-child(4){left:22px;}

    h1{
      margin:0;
      font-size:1.6rem;
      letter-spacing:.03em;
    }
    h1 span{
      color:var(--orange);
    }
    .subtitle{
      margin-top:2px;
      font-size:.9rem;
      color:var(--muted);
    }

    /* Info strip */
    .infoStrip{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-bottom:22px;
    }
    .tag{
      padding:6px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background:rgba(9,18,40,.8);
      font-size:.8rem;
      color:var(--muted);
    }
    .tag b{color:var(--orange);}

    /* Grid of rounds */
    .grid{
      display:grid;
      gap:16px;
      grid-template-columns:repeat(2,minmax(0,1fr));
    }
    @media (max-width:720px){
      .grid{grid-template-columns:1fr;}
    }

    .card{
      background:linear-gradient(145deg,var(--navy-3),var(--navy-2));
      border-radius:18px;
      border:1px solid var(--border);
      padding:16px 16px 14px;
      box-shadow:0 10px 25px rgba(0,0,0,.55);
      position:relative;
      overflow:hidden;
    }
    .card::after{
      content:"";
      position:absolute;
      inset:-40%;
      background:radial-gradient(circle at top right,rgba(220,68,5,.18),transparent 55%);
      opacity:.8;
      pointer-events:none;
    }
    .cardHeader{
      position:relative;
      z-index:1;
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px;
      gap:10px;
      flex-wrap:wrap;
    }
    .cardTitle{
      font-size:1.05rem;
      font-weight:700;
    }
    .cardTitle span{
      color:var(--orange);
    }
    .roundTag{
      font-size:.76rem;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:var(--muted);
      border-radius:999px;
      border:1px solid rgba(255,255,255,.2);
      padding:4px 10px;
      background:rgba(3,8,20,.9);
    }

    .cardBody{
      position:relative;
      z-index:1;
    }
    .cardBody p{
      margin:0 0 10px;
      font-size:.85rem;
      color:var(--muted);
    }

    .linkRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:4px;
    }
    .btnLink{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:7px 13px;
      border-radius:999px;
      font-size:.85rem;
      font-weight:600;
      text-decoration:none;
      cursor:pointer;
    }
    .btnPrimary{
      background:var(--orange);
      color:#fff;
      border:1px solid var(--orange);
    }
    .btnPrimary:hover{
      background:#ff6a1a;
    }
    .btnGhost{
      background:rgba(8,14,30,.9);
      color:var(--text);
      border:1px solid var(--border);
    }
    .btnGhost:hover{
      border-color:var(--orange);
      color:var(--orange);
    }

    .btnIcon{
      font-size:.8rem;
      line-height:1;
    }

    /* ===== Historical Winners ===== */
    .winnersWrap{
      margin-top:18px;
    }
    .winnersNote{
      margin:0;
      font-size:.84rem;
      color:var(--muted);
    }
    .tableShell{
      margin-top:10px;
      border:1px solid var(--border);
      border-radius:14px;
      overflow:hidden;
      background:rgba(3,8,20,.6);
    }
    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      font-size:.9rem;
    }
    thead th{
      text-align:left;
      font-size:.78rem;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
      background:rgba(9,18,40,.9);
      border-bottom:1px solid var(--border);
      padding:10px 12px;
      white-space:nowrap;
    }
    tbody td{
      padding:10px 12px;
      border-bottom:1px solid rgba(39,56,94,.6);
      vertical-align:top;
    }
    tbody tr:last-child td{border-bottom:none;}
    .num{ text-align:right; font-variant-numeric:tabular-nums; }
    .muted{ color:var(--muted); }
    .pill{
      display:inline-block;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(3,8,20,.65);
      color:var(--text);
      font-size:.82rem;
      white-space:nowrap;
    }

    footer{
      margin-top:26px;
      font-size:.78rem;
      color:var(--muted);
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logoBall" aria-hidden="true">
        <div class="laces">
          <span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div>
        <h1><span>Playoff</span> Pick‚Äôem Hub</h1>
        <div class="subtitle">Jump to any round to view the lines or everyone‚Äôs picks.</div>
      </div>
    </header>

    <div class="infoStrip">
      <div class="tag"><b>Tip:</b> Bookmark this hub ‚Äì all weekly links live here.</div>
      <div class="tag">Links will go live as each round opens.</div>
    </div>

    <main class="grid">
      <!-- Wild Card -->
      <section class="card">
        <div class="cardHeader">
          <div class="cardTitle"><span>Wild Card</span> Weekend</div>
          <div class="roundTag">Round 1</div>
        </div>
        <div class="cardBody">
          <p>View the Wild Card lines or check everyone‚Äôs picks and standings.</p>
          <div class="linkRow">
            <a class="btnLink btnPrimary" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/WildCard">
              <span class="btnIcon">üèà</span>
              <span>Lines / Make Picks</span>
            </a>
            <a class="btnLink btnGhost" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/WildCardPicks">
              <span class="btnIcon">üìä</span>
              <span>Picks & Standings</span>
            </a>
          </div>
        </div>
      </section>

      <!-- Divisional -->
      <section class="card">
        <div class="cardHeader">
          <div class="cardTitle"><span>Divisional</span> Round</div>
          <div class="roundTag">Round 2</div>
        </div>
        <div class="cardBody">
          <p>Lines and group picks for the Divisional round once it opens.</p>
          <div class="linkRow">
            <a class="btnLink btnPrimary" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/Divisional">
              <span class="btnIcon">üèà</span>
              <span>Lines / Make Picks</span>
            </a>
            <a class="btnLink btnGhost" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/DivisionalPicks">
              <span class="btnIcon">üìä</span>
              <span>Picks & Standings</span>
            </a>
          </div>
        </div>
      </section>

      <!-- Conference Championships -->
      <section class="card">
        <div class="cardHeader">
          <div class="cardTitle"><span>Conference</span> Championships</div>
          <div class="roundTag">Round 3</div>
        </div>
        <div class="cardBody">
          <p>Track who‚Äôs still alive heading into Championship Sunday.</p>
          <div class="linkRow">
            <a class="btnLink btnPrimary" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/Conference">
              <span class="btnIcon">üèà</span>
              <span>Lines / Make Picks</span>
            </a>
            <a class="btnLink btnGhost" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/ConferencePicks">
              <span class="btnIcon">üìä</span>
              <span>Picks & Standings</span>
            </a>
          </div>
        </div>
      </section>

      <!-- Super Bowl -->
      <section class="card">
        <div class="cardHeader">
          <div class="cardTitle"><span>Super Bowl</span> Finale</div>
          <div class="roundTag">Round 4</div>
        </div>
        <div class="cardBody">
          <p>The final round: big game lines and the last round of picks.</p>
          <div class="linkRow">
            <a class="btnLink btnPrimary" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/SuperBowl">
              <span class="btnIcon">üèà</span>
              <span>Lines / Make Picks</span>
            </a>
            <a class="btnLink btnGhost" href="https://wrathofmath85.github.io/NFL_Playoff_Pool/SuperBowlPicks">
              <span class="btnIcon">üìä</span>
              <span>Picks & Standings</span>
            </a>
          </div>
        </div>
      </section>
    </main>

    <!-- ===== Historical Winners (NEW) ===== -->
    <section class="card winnersWrap" aria-labelledby="histWinnersTitle">
      <div class="cardHeader">
        <div class="cardTitle" id="histWinnersTitle"><span>Historical</span> Winners</div>
        <div class="roundTag">All Years</div>
      </div>
      <div class="cardBody">
        <p class="winnersNote">
          Past champs and payouts (pulled live from your Google Sheet CSV).
          <span class="pill" id="winnersStatus">Loading‚Ä¶</span>
        </p>

        <div class="tableShell" role="region" aria-label="Historical winners table">
          <table>
            <thead>
              <tr>
                <th style="width:110px;">Year</th>
                <th>Champ</th>
                <th class="num" style="width:170px;">Won with</th>
              </tr>
            </thead>
            <tbody id="winnersBody">
              <tr>
                <td colspan="3" class="muted">Loading‚Ä¶</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <footer>
      GitHub Pages ‚Ä¢ Playoff Pick‚Äôem
    </footer>
  </div>

  <script>
    // ===== CONFIG: Historical winners CSV =====
    const WINNERS_CSV_URL =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vTYrB51f7zbtdxC794-EO-FgaqHq3ZFmKilje5qGmCJJ9SjuIIMLfzlOZCf1p5PGpSc9N_swz9cRBM7/pub?gid=1357054139&single=true&output=csv";

    const winnersBody   = document.getElementById("winnersBody");
    const winnersStatus = document.getElementById("winnersStatus");

    function setStatus(text, ok=true){
      winnersStatus.textContent = text;
      winnersStatus.style.borderColor = ok ? "rgba(255,255,255,.18)" : "rgba(220,68,5,.7)";
      winnersStatus.style.color = ok ? "var(--text)" : "var(--orange)";
    }

    function esc(s){
      return String(s ?? "").replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      }[c]));
    }

    function normalizeKey(k){
      return String(k || "")
        .trim()
        .toLowerCase()
        .replace(/\s+/g, "");
    }

    function renderWinners(rows){
      // Expect columns: Year, Champ, Won with
      // But be tolerant about header naming/casing/spacing
      const mapped = rows
        .map(r => {
          const keys = Object.keys(r || {});
          const get = (want) => {
            const w = normalizeKey(want);
            const hit = keys.find(k => normalizeKey(k) === w);
            return hit ? r[hit] : "";
          };
          const year = get("Year");
          const champ = get("Champ");
          const wonWith = get("Won with") || get("WonWith") || get("Won");
          return { year, champ, wonWith };
        })
        .filter(x => String(x.year).trim() !== "" || String(x.champ).trim() !== "" || String(x.wonWith).trim() !== "");

      // Sort by Year desc if numeric
      mapped.sort((a,b) => (parseInt(b.year,10) || 0) - (parseInt(a.year,10) || 0));

      if (!mapped.length){
        winnersBody.innerHTML = `<tr><td colspan="3" class="muted">No winner rows found in the CSV.</td></tr>`;
        setStatus("No data", false);
        return;
      }

      winnersBody.innerHTML = mapped.map(x => `
        <tr>
          <td>${esc(x.year)}</td>
          <td>${esc(x.champ)}</td>
          <td class="num">${esc(x.wonWith)}</td>
        </tr>
      `).join("");

      setStatus("Updated ‚úì", true);
    }

    function loadWinners(){
      setStatus("Loading‚Ä¶", true);
      Papa.parse(WINNERS_CSV_URL, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: (results) => {
          const data = results && results.data ? results.data : [];
          renderWinners(data);
        },
        error: () => {
          winnersBody.innerHTML = `<tr><td colspan="3" class="muted">Couldn‚Äôt load the winners CSV.</td></tr>`;
          setStatus("Load failed", false);
        }
      });
    }

    loadWinners();
  </script>
</body>
</html>
