<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Wild Card Lines</title>
<style>
  :root{
    --bg:#0b0d12; --card:#141826; --muted:#8ea0b5;
    --pill:#1e2538; --pill-hover:#28304a; --pill-active:#3553ff22;
    --accent:#8ab4ff; --border:#2b3550;
  }
  html,body{margin:0;background:var(--bg);color:#e8f0ff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;}
  .wrap{max-width:1100px;margin:auto;padding:22px;}
  h1{margin:0 0 10px}
  .hint{color:var(--muted);margin:0 0 18px}
  .game{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px;margin:12px 0}
  .head{display:flex;gap:10px;align-items:center;flex-wrap:wrap;border-bottom:1px dashed var(--border);padding:0 4px 10px;margin-bottom:10px}
  .when{color:var(--muted);font-size:.92rem}
  .teams{font-weight:700}
  .row{display:grid;grid-template-columns:1fr 1fr 120px 140px;gap:8px;align-items:stretch;margin:8px 0}
  @media (max-width:780px){ .row{grid-template-columns:1fr;}}
  .rowlabel{grid-column:1 / -1;color:var(--muted);font-size:.84rem;margin-top:6px}
  .pill{
    border:1px solid var(--border);background:var(--pill);border-radius:10px;
    padding:10px;cursor:pointer;display:flex;justify-content:space-between;gap:8px;
    transition:background .15s,box-shadow .15s;
  }
  .pill:hover{background:var(--pill-hover)}
  .pill.active{box-shadow:0 0 0 2px var(--accent) inset;background:var(--pill-active)}
  .pill .name{font-weight:600}
  .pill .odds{color:var(--muted)}
  .money input{
    width:100%;height:100%;box-sizing:border-box;border-radius:10px;border:1px solid var(--border);
    background:#0f1422;color:#e8f0ff;font-size:16px;padding:10px 12px;outline:none;
  }
  .payout{
    background:#0f1422;border:1px solid var(--border);border-radius:10px;display:flex;align-items:center;justify-content:center;
    font-weight:700
  }
  footer{color:var(--muted);font-size:.85rem;margin-top:18px}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Wild Card Lines</h1>
    <p class="hint">Each game has <b>Moneyline</b>, <b>Spread</b>, and <b>Total (O/U)</b> rows. Click a pill, type a wager, and we’ll compute <em>To Win</em> for that row.</p>

    <div id="games"></div>

    <footer>Payout: negative odds → wager + (wager / |odds|) * 100; positive odds → wager + (wager / 100) * odds.</footer>
  </div>

  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    // ====== CONFIG ======
    const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTYrB51f7zbtdxC794-EO-FgaqHq3ZFmKilje5qGmCJJ9SjuIIMLfzlOZCf1p5PGpSc9N_swz9cRBM7/pub?gid=0&single=true&output=csv"; // <-- replace
    const COLS = {
      date: "Date",
      time: "Time",
      channel: "Channel",
      away: "Away",
      aSu: "A SU Line",
      aSpread: "A Spread",
      aSpreadLine: "A Spread Line",
      home: "Home",
      hSu: "H SU Line",
      hSpread: "H Spread",
      hSpreadLine: "H Spread Line",
      ouTotal: "Over/Under",
      oLine: "O Line",
      uLine: "U Line"
    };
    // =====================

    const fmtSigned = n => (n === "" || n === null || isNaN(n)) ? "" : (Number(n)>0?`+${Number(n)}`:`${Number(n)}`);
    function computePayout(wager, odds){
      const w = Number(wager||0), o = Number(odds);
      if(!w || !o) return 0;
      if(o < 0) return w + (w/Math.abs(o))*100;
      return w + (w/100)*o;
    }

    function pill(label, odds, gameId, group){
      const el = document.createElement("button");
      el.type = "button";
      el.className = "pill";
      el.dataset.gameId = gameId;
      el.dataset.group = group;
      el.dataset.odds = odds ?? "";
      el.innerHTML = `<span class="name">${label}</span><span class="odds">${fmtSigned(odds)}</span>`;
      el.addEventListener("click", () => {
        const scope = document.querySelector(`.game[data-id="${gameId}"] .row[data-group="${group}"]`);
        scope.querySelectorAll(".pill").forEach(p=>p.classList.remove("active"));
        el.classList.add("active");
        updateRow(scope);
      });
      return el;
    }

    function updateRow(scope){
      const wager = scope.querySelector("input.wager").value;
      const active = scope.querySelector(".pill.active");
      const payoutEl = scope.querySelector(".payout");
      if(!active || !wager){ payoutEl.textContent = "—"; return; }
      const odds = Number(active.dataset.odds);
      const total = computePayout(wager, odds);
      payoutEl.textContent = isFinite(total) ? `$${total.toFixed(2)}` : "—";
    }

    function buildGameRow(row, idx){
      const game = document.createElement("section");
      game.className = "game";
      game.dataset.id = idx;

      const head = document.createElement("div");
      head.className = "head";
      const teams = document.createElement("div");
      teams.className = "teams";
      teams.textContent = `${row[COLS.away]} @ ${row[COLS.home]}`;
      const when = document.createElement("div");
      when.className = "when";
      when.textContent = `${row[COLS.date]} • ${row[COLS.time]} • ${row[COLS.channel]}`;
      head.append(teams, when);
      game.appendChild(head);

      // Moneyline row
      game.appendChild(buildRow(
        idx, "ml", "Moneyline",
        pill(row[COLS.away], row[COLS.aSu], idx, "ml"),
        pill(row[COLS.home], row[COLS.hSu], idx, "ml")
      ));

      // Spread row
      game.appendChild(buildRow(
        idx, "spread", "Spread",
        pill(`${row[COLS.away]} (${fmtSigned(row[COLS.aSpread])})`, row[COLS.aSpreadLine], idx, "spread"),
        pill(`${row[COLS.home]} (${fmtSigned(row[COLS.hSpread])})`, row[COLS.hSpreadLine], idx, "spread")
      ));

      // Total row
      game.appendChild(buildRow(
        idx, "total", "Total (O/U)",
        pill(`Over ${row[COLS.ouTotal]}`, row[COLS.oLine], idx, "total"),
        pill(`Under ${row[COLS.ouTotal]}`, row[COLS.uLine], idx, "total")
      ));

      return game;
    }

    function buildRow(idx, group, label, pillLeft, pillRight){
      const lab = document.createElement("div");
      lab.className = "rowlabel";
      lab.textContent = label;

      const r = document.createElement("div");
      r.className = "row";
      r.dataset.group = group;

      // two pills
      r.append(pillLeft, pillRight);

      // wager input
      const wagerWrap = document.createElement("div");
      wagerWrap.className = "money";
      const wagerInput = document.createElement("input");
      wagerInput.type = "number"; wagerInput.min = "0"; wagerInput.step = "1";
      wagerInput.placeholder = "Wager";
      wagerInput.className = "wager";
      wagerInput.addEventListener("input", () => updateRow(r));
      wagerWrap.append(wagerInput);

      // payout
      const payout = document.createElement("div");
      payout.className = "payout";
      payout.textContent = "—";

      r.append(wagerWrap, payout);

      const frag = document.createDocumentFragment();
      frag.append(lab, r);
      return frag;
    }

    function render(rows){
      const container = document.getElementById("games");
      container.innerHTML = "";
      rows.forEach((r,i)=>{
        if(!(r[COLS.away] && r[COLS.home])) return;
        container.appendChild(buildGameRow(r,i));
      });
    }

    function load(){
      if(!SHEET_CSV_URL || SHEET_CSV_URL.startsWith("PASTE_")){
        // demo row if URL not set yet
        render([
          {"Date":"Saturday","Time":"4:30 PM","Channel":"CBS","Away":"Chargers","A SU Line":"-154","A Spread":"-2.5","A Spread Line":"-118","Home":"Texans","H SU Line":"130","H Spread":"2.5","H Spread Line":"-104","Over/Under":"42.5","O Line":"-110","U Line":"-110"}
        ]);
        return;
      }
      Papa.parse(SHEET_CSV_URL,{download:true,header:true,dynamicTyping:true,skipEmptyLines:true,complete:(res)=>render(res.data)});
    }
    load();
  </script>
</body>
</html>
